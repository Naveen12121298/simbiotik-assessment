<!-- route-planner.component.html -->
<div class="max-w-2xl mx-auto p-6 bg-white shadow-xl rounded-xl space-y-4">

  <h2 class="text-2xl font-bold text-gray-800 text-center">Route Planner</h2>

  <!-- From Input -->
  <div class="relative">
    <label for="from" class="block text-sm font-medium text-gray-700">From</label>
    <input
      id="from"
      type="text"
      [(ngModel)]="fromQuery"
      placeholder="Starting Point"
      (input)="searchFrom()"
      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition"
    />
    <ul *ngIf="fromResults.length" class="absolute z-50 w-full bg-white border border-gray-200 mt-1 rounded-md max-h-40 overflow-auto shadow-lg">
      <li *ngFor="let r of fromResults" (click)="selectFrom(r)" class="px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm">
        {{ r.display_name }}
      </li>
    </ul>
  </div>

  <!-- To Input -->
  <div class="relative pt-1">
    <label for="to" class="block text-sm font-medium text-gray-700">To</label>
    <input
      id="to"
      type="text"
      [(ngModel)]="toQuery"
      placeholder="Destination"
      (input)="searchTo()"
      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition"
    />
    <ul *ngIf="toResults.length" class="absolute z-50 w-full bg-white border border-gray-200 mt-1 rounded-md max-h-40 overflow-auto shadow-lg">
      <li *ngFor="let r of toResults" (click)="selectTo(r)" class="px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm">
        {{ r.display_name }}
      </li>
    </ul>
  </div>

  <!-- Search Route Button -->
  <div>
    <button
      (click)="tryRoute()"
      [disabled]="!fromQuery || !toQuery || loadingRoute"
      class="w-full px-4 py-3 text-lg font-semibold rounded-lg text-white transition duration-200"
      [ngClass]="{
        'bg-blue-600 hover:bg-blue-700': !loadingRoute && fromQuery && toQuery,
        'bg-blue-200 cursor-not-allowed opacity-70': loadingRoute || !fromQuery || !toQuery
      }"
    >
      <span *ngIf="!loadingRoute">Search Route</span>
      <span *ngIf="loadingRoute" class="flex items-center justify-center">
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Calculating...
      </span>
    </button>
  </div>
</div>

<!-- Map and Route Info -->
<div *ngIf="showMap" class="max-w-2xl mx-auto p-6 bg-white shadow-xl rounded-xl space-y-4 mt-6">
  <div id="map" class="w-full h-[60vh] rounded-xl border border-gray-300 shadow-md"></div>

  <div *ngIf="routeInfo" class="p-4 bg-blue-50 border border-blue-200 rounded-lg text-blue-800">
    <p class="text-lg font-semibold">Route Details:</p>
    <p>
      <strong class="font-medium">Distance:</strong>
      <span class="text-blue-700">{{ routeInfo.distance }} km</span>
    </p>
    <p>
      <strong class="font-medium">Duration (Est.):</strong>
      <span class="text-blue-700">{{ routeInfo.duration }} mins</span>
    </p>
  </div>
</div>
